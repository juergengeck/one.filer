"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "lib_filer_FuseFrontend_js";
exports.ids = ["lib_filer_FuseFrontend_js"];
exports.modules = {

/***/ "../lib/filer/FuseApiToIFileSystemAdapter.js":
/*!***************************************************!*\
  !*** ../lib/filer/FuseApiToIFileSystemAdapter.js ***!
  \***************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ FuseApiToIFileSystemAdapter)\n/* harmony export */ });\n/* harmony import */ var _fuse_types_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../fuse/types.js */ \"../lib/fuse/types.js\");\n/* harmony import */ var _refinio_one_models_lib_misc_OEvent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @refinio/one.models/lib/misc/OEvent.js */ \"../node_modules/@refinio/one.models/lib/misc/OEvent.js\");\n/* harmony import */ var _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @refinio/one.models/lib/fileSystems/FileSystemErrors.js */ \"../node_modules/@refinio/one.models/lib/fileSystems/FileSystemErrors.js\");\n/* harmony import */ var _refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @refinio/one.core/lib/errors.js */ \"../node_modules/@refinio/one.core/lib/errors.js\");\n/* harmony import */ var _misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../misc/fuseHelper.js */ \"../lib/misc/fuseHelper.js\");\n/* harmony import */ var _FuseTemporaryFilesManager_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./FuseTemporaryFilesManager.js */ \"../lib/filer/FuseTemporaryFilesManager.js\");\n\n\n\n\n\n\nlet fuseFd = 10;\nclass FuseApiToIFileSystemAdapter {\n    onFilePersisted = new _refinio_one_models_lib_misc_OEvent_js__WEBPACK_IMPORTED_MODULE_1__.OEvent();\n    constTimes = new Date();\n    regularFileMode = 0o0100666;\n    fs;\n    logCalls;\n    tmpFilesMgr;\n    temporaryFileDescriptorToFileMap = new Map();\n    constructor(fs, oneStoragePath, logCalls = false) {\n        this.fs = fs;\n        this.logCalls = logCalls;\n        this.tmpFilesMgr = new _FuseTemporaryFilesManager_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"](oneStoragePath);\n    }\n    fuseInit(cb) {\n        cb(0);\n    }\n    fuseError(cb) {\n        cb(0);\n    }\n    getUid() {\n        return typeof process.getuid === 'function' ? process.getuid() : 0;\n    }\n    getGid() {\n        return typeof process.getgid === 'function' ? process.getgid() : 0;\n    }\n    fuseGetattr(path, cb) {\n        const tmpFile = Array.from(this.temporaryFileDescriptorToFileMap.values()).find(description => description.path === path);\n        if (tmpFile) {\n            try {\n                const fileStat = this.tmpFilesMgr.statTemporaryFile(tmpFile.fileName);\n                cb(0, {\n                    mtime: this.constTimes,\n                    atime: this.constTimes,\n                    ctime: this.constTimes,\n                    size: fileStat.size,\n                    mode: fileStat.mode,\n                    uid: this.getUid(),\n                    gid: this.getGid()\n                });\n            }\n            catch (_e) {\n                new Promise((resolve, reject) => {\n                    let disconnect = null;\n                    const handler = (state) => {\n                        if (state.path === path) {\n                            if (disconnect) {\n                                disconnect();\n                            }\n                            this.fs\n                                .stat(path)\n                                .then((res) => {\n                                resolve({\n                                    mtime: this.constTimes,\n                                    atime: this.constTimes,\n                                    ctime: this.constTimes,\n                                    size: res.size,\n                                    mode: res.mode,\n                                    uid: this.getUid(),\n                                    gid: this.getGid()\n                                });\n                            })\n                                .catch((err) => reject(err));\n                        }\n                    };\n                    disconnect = this.onFilePersisted.listen(handler);\n                    setTimeout(() => {\n                        if (disconnect) {\n                            disconnect();\n                        }\n                        reject((0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_3__.createError)('FSE-ENOENT', {\n                            message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_2__.FS_ERRORS['FSE-ENOENT'].message,\n                            path\n                        }));\n                    }, 10000);\n                })\n                    .then(res => cb(0, res))\n                    .catch(err => cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)(err, this.logCalls, 'getattr')));\n            }\n        }\n        else {\n            this.fs\n                .stat(path)\n                .then((res) => {\n                cb(0, {\n                    mtime: this.constTimes,\n                    atime: this.constTimes,\n                    ctime: this.constTimes,\n                    size: res.size,\n                    mode: res.mode,\n                    uid: this.getUid(),\n                    gid: this.getGid()\n                });\n            })\n                .catch((err) => cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)(err, this.logCalls, 'getattr')));\n        }\n    }\n    fuseFtruncate(_path, _fd, _size, cb) {\n        cb(0);\n    }\n    fuseTruncate(_path, _size, cb) {\n        cb(0);\n    }\n    fuseReaddir(path, cb) {\n        this.fs\n            .readDir(path)\n            .then((res) => cb(0, res.children))\n            .catch((err) => cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)(err, this.logCalls)));\n    }\n    fuseOpendir(_path, _flags, cb) {\n        cb(0, fuseFd++);\n    }\n    fuseOpen(_path, _flags, cb) {\n        cb(0, fuseFd++);\n    }\n    fuseRead(givenPath, _fd, buffer, length, position, cb) {\n        if (this.fs.supportsChunkedReading(givenPath)) {\n            this.fs\n                .readFileInChunks(givenPath, length, position)\n                .then((res) => {\n                const bufferR = Buffer.from(res.content);\n                bufferR.copy(buffer);\n                cb(0, bufferR.length);\n            })\n                .catch((err) => cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)(err, this.logCalls), 0));\n        }\n        else {\n            this.fs\n                .readFile(givenPath)\n                .then((res) => {\n                const content = Buffer.from(res.content);\n                const end = Math.min(position + length, content.length);\n                const slice = content.slice(position, end);\n                slice.copy(buffer);\n                cb(0, slice.length);\n            })\n                .catch((err) => cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)(err, this.logCalls), 0));\n        }\n    }\n    fuseMkdir(dirPath, _mode, cb) {\n        this.fs\n            .createDir(dirPath, 0o0040777)\n            .then(() => cb(0))\n            .catch((err) => cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)(err, this.logCalls)));\n    }\n    fuseFlush(_path, fd, cb) {\n        const fileName = this.temporaryFileDescriptorToFileMap.get(fd);\n        if (fileName) {\n            cb(0);\n        }\n        else {\n            cb(0);\n        }\n    }\n    fuseRelease(path, fd, cb) {\n        let fileDescription = this.temporaryFileDescriptorToFileMap.get(fd);\n        if (fileDescription === undefined) {\n            try {\n                const fileName = path.substring(path.lastIndexOf('/') + 1);\n                this.tmpFilesMgr.retrieveTemporaryFilePath(fileName);\n                fileDescription = { fileName: fileName, path: path };\n            }\n            catch (_e) {\n                fileDescription = undefined;\n            }\n        }\n        if (fileDescription) {\n            const fileName = fileDescription.fileName;\n            this.tmpFilesMgr\n                .releaseTemporaryFile(path.substring(0, path.lastIndexOf('/')), fileDescription.fileName)\n                .then(blobHash => this.fs.createFile(path.substring(0, path.lastIndexOf('/')), blobHash, fileName, this.regularFileMode))\n                .then(() => {\n                this.temporaryFileDescriptorToFileMap.delete(fd);\n                this.onFilePersisted.emit({ path: path });\n                cb(0);\n            })\n                .catch(err => cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)(err, this.logCalls)));\n        }\n        else {\n            cb(_fuse_types_js__WEBPACK_IMPORTED_MODULE_0__.ENOENT);\n        }\n    }\n    fuseReleasedir(_path, _fd, cb) {\n        cb(0);\n    }\n    fuseUnlink(path, cb) {\n        this.fs\n            .unlink(path)\n            .then((result) => cb(result))\n            .catch((err) => cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)(err, this.logCalls)));\n    }\n    fuseRename(src, dest, cb) {\n        this.fs\n            .rename(src, dest)\n            .then((result) => cb(result))\n            .catch((err) => cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)(err, this.logCalls)));\n    }\n    fuseRmdir(path, cb) {\n        this.fs\n            .rmdir(path)\n            .then((result) => cb(result))\n            .catch((err) => cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)(err, this.logCalls)));\n    }\n    fuseChmod(path, mode, cb) {\n        this.fs\n            .chmod(path, mode)\n            .then((result) => cb(result))\n            .catch((err) => cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)(err, this.logCalls)));\n    }\n    fuseMknod(_path, _mode, _dev, cb) {\n        cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)((0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_3__.createError)('FSE-ENOSYS', {\n            message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_2__.FS_ERRORS['FSE-ENOSYS'].message\n        }), this.logCalls, 'mknod'));\n    }\n    fuseSetxattr(_path, _name, _value, _size, _flags, cb) {\n        cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)((0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_3__.createError)('FSE-ENOSYS', {\n            message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_2__.FS_ERRORS['FSE-ENOSYS'].message\n        }), this.logCalls, 'setxattr'));\n    }\n    fuseGetxattr(_path, _name, _size, cb) {\n        cb(0, null);\n    }\n    fuseListxattr(_path, cb) {\n        cb(0, []);\n    }\n    fuseRemovexattr(_path, _name, cb) {\n        cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)((0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_3__.createError)('FSE-ENOSYS', {\n            message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_2__.FS_ERRORS['FSE-ENOSYS'].message\n        }), this.logCalls, 'removexattr'));\n    }\n    fuseCreate(givenPath, mode, cb) {\n        const fileName = givenPath.substring(givenPath.lastIndexOf('/') + 1);\n        this.tmpFilesMgr\n            .createTemporaryFile(fileName)\n            .then(fd => {\n            this.temporaryFileDescriptorToFileMap.set(fd, {\n                fileName: fileName,\n                path: givenPath\n            });\n            cb(0, fd, mode);\n        })\n            .catch(err => cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)(err, this.logCalls)));\n    }\n    fuseWrite(givenPath, _fd, buffer, length, position, cb) {\n        this.tmpFilesMgr\n            .writeToTemporaryFile(givenPath, buffer, length, position)\n            .then(bytesWritten => cb(0, bytesWritten))\n            .catch(err => cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)(err, this.logCalls), 0));\n    }\n    fuseAccess(_path, _mode, cb) {\n        cb(0);\n    }\n    fuseStatfs(_path, cb) {\n        cb(0, {\n            bsize: 1000000,\n            frsize: 1000000,\n            blocks: 1000000,\n            bfree: 1000000,\n            bavail: 1000000,\n            files: 1000000,\n            ffree: 1000000,\n            favail: 1000000,\n            fsid: 1000000,\n            flag: 1000000,\n            namemax: 1000000\n        });\n    }\n    fuseFgetattr(_path, _fd, cb) {\n        cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)((0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_3__.createError)('FSE-ENOSYS', {\n            message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_2__.FS_ERRORS['FSE-ENOSYS'].message\n        }), this.logCalls, 'fgetattr'));\n    }\n    fuseChown(_path, _uid, _gid, cb) {\n        cb(0);\n    }\n    fuseUtimens(_path, _atime, _mtime, cb) {\n        cb(0);\n    }\n    fuseLink(_src, _dest, cb) {\n        cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)((0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_3__.createError)('FSE-ENOSYS', {\n            message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_2__.FS_ERRORS['FSE-ENOSYS'].message\n        }), this.logCalls, 'link'));\n    }\n    fuseSymlink(src, dest, cb) {\n        this.fs\n            .symlink(src, dest)\n            .then(() => cb(0))\n            .catch((err) => cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)(err, this.logCalls)));\n    }\n    fuseReadlink(path, cb) {\n        this.fs\n            .readlink(path)\n            .then((res) => cb(0, Buffer.from(res.content).toString()))\n            .catch((err) => cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)(err, this.logCalls)));\n    }\n    fuseFsync(_path, _datasync, _fd, cb) {\n        cb(0);\n    }\n    fuseFsyncdir(_path, _datasync, _fd, cb) {\n        cb((0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_4__.handleError)((0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_3__.createError)('FSE-ENOSYS', {\n            message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_2__.FS_ERRORS['FSE-ENOSYS'].message\n        }), this.logCalls, 'fsyncdir'));\n    }\n}\n//# sourceMappingURL=FuseApiToIFileSystemAdapter.js.map\n\n//# sourceURL=webpack://one-filer-login/../lib/filer/FuseApiToIFileSystemAdapter.js?\n}");

/***/ }),

/***/ "../lib/filer/FuseFrontend.js":
/*!************************************!*\
  !*** ../lib/filer/FuseFrontend.js ***!
  \************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FuseFrontend: () => (/* binding */ FuseFrontend)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var _FuseApiToIFileSystemAdapter_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./FuseApiToIFileSystemAdapter.js */ \"../lib/filer/FuseApiToIFileSystemAdapter.js\");\n/* harmony import */ var _misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../misc/fuseHelper.js */ \"../lib/misc/fuseHelper.js\");\n/* harmony import */ var _utils_typeChecks_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/typeChecks.js */ \"../lib/utils/typeChecks.js\");\n/* harmony import */ var _fuse_index_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../fuse/index.js */ \"../lib/fuse/index.js\");\n\n\n\n\n\n\nclass FuseFrontend {\n    fuseInstance = null;\n    Fuse;\n    async start(rootFileSystem, mountPoint, logCalls = false, fuseOptions = {}) {\n        if (this.fuseInstance) {\n            throw Error('Fuse frontend already started');\n        }\n        this.Fuse = await (0,_fuse_index_js__WEBPACK_IMPORTED_MODULE_5__.getFuse)();\n        const absoluteMountPoint = path__WEBPACK_IMPORTED_MODULE_1__.resolve(mountPoint);\n        console.log(`ðŸ”§ Resolved mount point: ${mountPoint} -> ${absoluteMountPoint}`);\n        FuseFrontend.setupMountPoint(absoluteMountPoint);\n        const fuseFileSystemAdapter = new _FuseApiToIFileSystemAdapter_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](rootFileSystem, absoluteMountPoint, logCalls);\n        const fuseHandlers = {\n            init: (cb) => {\n                console.log('ðŸ”§ FUSE init called');\n                fuseFileSystemAdapter.fuseInit(cb);\n            },\n            error: (err) => {\n                console.error('ðŸ”§ FUSE error called:', err);\n                fuseFileSystemAdapter.fuseError(() => { });\n            },\n            getattr: (path, cb) => {\n                console.log('ðŸ”§ FUSE getattr called:', path);\n                fuseFileSystemAdapter.fuseGetattr(path, cb);\n            },\n            readdir: (path, cb) => {\n                console.log('ðŸ”§ FUSE readdir called:', path);\n                fuseFileSystemAdapter.fuseReaddir(path, cb);\n            },\n            access: fuseFileSystemAdapter.fuseAccess.bind(fuseFileSystemAdapter),\n            statfs: fuseFileSystemAdapter.fuseStatfs.bind(fuseFileSystemAdapter),\n            fgetattr: fuseFileSystemAdapter.fuseFgetattr.bind(fuseFileSystemAdapter),\n            flush: fuseFileSystemAdapter.fuseFlush.bind(fuseFileSystemAdapter),\n            fsync: fuseFileSystemAdapter.fuseFsync.bind(fuseFileSystemAdapter),\n            fsyncdir: fuseFileSystemAdapter.fuseFsyncdir.bind(fuseFileSystemAdapter),\n            truncate: fuseFileSystemAdapter.fuseTruncate.bind(fuseFileSystemAdapter),\n            ftruncate: fuseFileSystemAdapter.fuseFtruncate.bind(fuseFileSystemAdapter),\n            readlink: fuseFileSystemAdapter.fuseReadlink.bind(fuseFileSystemAdapter),\n            chown: fuseFileSystemAdapter.fuseChown.bind(fuseFileSystemAdapter),\n            chmod: fuseFileSystemAdapter.fuseChmod.bind(fuseFileSystemAdapter),\n            mknod: fuseFileSystemAdapter.fuseMknod.bind(fuseFileSystemAdapter),\n            setxattr: fuseFileSystemAdapter.fuseSetxattr.bind(fuseFileSystemAdapter),\n            getxattr: (path, name, cb) => {\n                if (typeof cb !== 'function') {\n                    console.warn('ðŸ”§ FUSE getxattr called without callback:', { path, name });\n                    return;\n                }\n                fuseFileSystemAdapter.fuseGetxattr(path, name, 0, (err, xattr) => {\n                    cb(err, xattr || undefined);\n                });\n            },\n            listxattr: fuseFileSystemAdapter.fuseListxattr.bind(fuseFileSystemAdapter),\n            removexattr: fuseFileSystemAdapter.fuseRemovexattr.bind(fuseFileSystemAdapter),\n            open: fuseFileSystemAdapter.fuseOpen.bind(fuseFileSystemAdapter),\n            opendir: fuseFileSystemAdapter.fuseOpendir.bind(fuseFileSystemAdapter),\n            read: fuseFileSystemAdapter.fuseRead.bind(fuseFileSystemAdapter),\n            write: fuseFileSystemAdapter.fuseWrite.bind(fuseFileSystemAdapter),\n            release: fuseFileSystemAdapter.fuseRelease.bind(fuseFileSystemAdapter),\n            releasedir: fuseFileSystemAdapter.fuseReleasedir.bind(fuseFileSystemAdapter),\n            create: fuseFileSystemAdapter.fuseCreate.bind(fuseFileSystemAdapter),\n            utimens: (path, atime, mtime, cb) => {\n                fuseFileSystemAdapter.fuseUtimens(path, new Date(atime * 1000), new Date(mtime * 1000), cb);\n            },\n            unlink: fuseFileSystemAdapter.fuseUnlink.bind(fuseFileSystemAdapter),\n            rename: fuseFileSystemAdapter.fuseRename.bind(fuseFileSystemAdapter),\n            link: fuseFileSystemAdapter.fuseLink.bind(fuseFileSystemAdapter),\n            symlink: fuseFileSystemAdapter.fuseSymlink.bind(fuseFileSystemAdapter),\n            mkdir: fuseFileSystemAdapter.fuseMkdir.bind(fuseFileSystemAdapter),\n            rmdir: fuseFileSystemAdapter.fuseRmdir.bind(fuseFileSystemAdapter)\n        };\n        if (logCalls) {\n            for (const handlerId in fuseHandlers) {\n                const oldHandler = fuseHandlers[handlerId];\n                if (handlerId === 'init') {\n                    fuseHandlers[handlerId] = (...args) => FuseFrontend.logFuseCall(oldHandler, ...args);\n                }\n                else {\n                    fuseHandlers[handlerId] = (...args) => FuseFrontend.logFuseCallCB(handlerId, oldHandler, ...args);\n                }\n            }\n        }\n        const mountOptions = {\n            displayFolder: 'One FUSE',\n            ...fuseOptions\n        };\n        console.log('ðŸ”§ FUSE mount options:', mountOptions);\n        this.fuseInstance = new this.Fuse(absoluteMountPoint, fuseHandlers, mountOptions);\n        await new Promise((resolve, reject) => {\n            if (this.fuseInstance === null) {\n                reject(Error('Fuse frontend not yet started'));\n            }\n            else {\n                this.fuseInstance.mount((err) => (err === null ? resolve() : reject(err)));\n            }\n        });\n    }\n    async stop() {\n        if (this.fuseInstance) {\n            return new Promise((resolve, reject) => {\n                if (this.fuseInstance === null) {\n                    reject(Error('Fuse frontend not yet started'));\n                }\n                else {\n                    this.fuseInstance.unmount((err) => (err === null ? resolve() : reject(err)));\n                }\n            });\n        }\n    }\n    static async isFuseNativeConfigured() {\n        const Fuse = await (0,_fuse_index_js__WEBPACK_IMPORTED_MODULE_5__.getFuse)();\n        return new Promise((resolve, reject) => {\n            Fuse.isConfigured((err, isConfigured) => {\n                if (err !== null) {\n                    reject(err);\n                }\n                resolve(isConfigured);\n            });\n        });\n    }\n    static async configureFuseNative() {\n        const Fuse = await (0,_fuse_index_js__WEBPACK_IMPORTED_MODULE_5__.getFuse)();\n        return new Promise((resolve, reject) => {\n            Fuse.configure(errConfigure => {\n                if (errConfigure) {\n                    reject(new Error(`\\x1b[31mError: ${errConfigure.message}\\x1b[0m`));\n                }\n                else {\n                    resolve();\n                }\n            });\n        });\n    }\n    static setupMountPoint(mountPoint) {\n        switch (process.platform) {\n            case 'win32':\n                if (fs__WEBPACK_IMPORTED_MODULE_0__.existsSync(mountPoint)) {\n                    fs__WEBPACK_IMPORTED_MODULE_0__.rmdirSync(mountPoint);\n                }\n                break;\n            default:\n                if (!fs__WEBPACK_IMPORTED_MODULE_0__.existsSync(mountPoint)) {\n                    fs__WEBPACK_IMPORTED_MODULE_0__.mkdirSync(mountPoint);\n                }\n                break;\n        }\n    }\n    static logFuseCall(handler, ...args) {\n        handler(...args);\n    }\n    static logFuseCallCB(name, handler, ...args) {\n        const normalArgs = args.slice(0, -1);\n        const cbArg = args[args.length - 1];\n        if (!(0,_utils_typeChecks_js__WEBPACK_IMPORTED_MODULE_4__.isFunction)(cbArg)) {\n            throw new Error(`cbArg is not a function but ${typeof cbArg}: ${String(cbArg)}`);\n        }\n        handler(...normalArgs, (...argscb) => {\n            const returnedCode = parseInt(argscb[0], 10);\n            const route = String(normalArgs[0]) === '/'\n                ? '\\x1b[40mroot\\x1b[0m'\n                : String(normalArgs[0]).includes('/')\n                    ? `\\x1b[40m${(0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_3__.splitRoutePath)(normalArgs[0]).prefix}\\x1b[0m`\n                    : '';\n            if (route === '.git') {\n                cbArg(...argscb);\n                return;\n            }\n            if (returnedCode < 0) {\n                console.log('\\x1b[33m[WARN]:\\x1b[0m', route, `| \\x1b[33m${name}(${String(normalArgs)}) -> `, `\\x1b[35m${String(argscb[0])}\\x1b[0m`);\n            }\n            else {\n                console.log('\\x1b[32m[INFO]:\\x1b[0m', route, `| ${name}(${String(normalArgs)}) -> \\x1b[35m${String(argscb[0])}\\x1b[0m`);\n            }\n            cbArg(...argscb);\n        });\n    }\n}\n//# sourceMappingURL=FuseFrontend.js.map\n\n//# sourceURL=webpack://one-filer-login/../lib/filer/FuseFrontend.js?\n}");

/***/ }),

/***/ "../lib/filer/FuseTemporaryFilesManager.js":
/*!*************************************************!*\
  !*** ../lib/filer/FuseTemporaryFilesManager.js ***!
  \*************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ FuseTemporaryFilesManager)\n/* harmony export */ });\n/* harmony import */ var _refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @refinio/one.core/lib/errors.js */ \"../node_modules/@refinio/one.core/lib/errors.js\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var _refinio_one_core_lib_instance_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @refinio/one.core/lib/instance.js */ \"../node_modules/@refinio/one.core/lib/instance.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @refinio/one.models/lib/fileSystems/FileSystemErrors.js */ \"../node_modules/@refinio/one.models/lib/fileSystems/FileSystemErrors.js\");\n/* harmony import */ var _refinio_one_core_lib_storage_base_common_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @refinio/one.core/lib/storage-base-common.js */ \"../node_modules/@refinio/one.core/lib/storage-base-common.js\");\n/* harmony import */ var _misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../misc/fuseHelper.js */ \"../lib/misc/fuseHelper.js\");\n\n\n\n\n\n\n\n\n\nclass FuseTemporaryFilesManager {\n    oneStoragePath;\n    platform = process.platform;\n    fileToTemporaryFileMap = new Map();\n    constructor(storageName = 'data') {\n        this.oneStoragePath = path__WEBPACK_IMPORTED_MODULE_1__.join(storageName);\n    }\n    static getOnePath(storage, folder) {\n        const instanceIdHash = (0,_refinio_one_core_lib_instance_js__WEBPACK_IMPORTED_MODULE_4__.getInstanceIdHash)();\n        if (instanceIdHash === undefined) {\n            throw (0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('FSE-EINVAL', {\n                message: 'Instance ID hash is not set'\n            });\n        }\n        return path__WEBPACK_IMPORTED_MODULE_1__.resolve(process.cwd(), storage) + path__WEBPACK_IMPORTED_MODULE_1__.sep + instanceIdHash + path__WEBPACK_IMPORTED_MODULE_1__.sep + folder;\n    }\n    statTemporaryFile(fileName) {\n        const tmpFilePath = this.retrieveTemporaryFilePath(fileName);\n        try {\n            return fs__WEBPACK_IMPORTED_MODULE_2__.statSync(tmpFilePath);\n        }\n        catch (err) {\n            (0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_8__.logFuseError)(err, 'statTemporaryFile');\n            throw (0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('FSE-ENOENT', {\n                message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_6__.FS_ERRORS['FSE-ENOENT'].message,\n                path: fileName\n            });\n        }\n    }\n    async releaseTemporaryFile(_directoryPath, fileName) {\n        this.throwErrorForMacOSHiddenFiles(fileName);\n        const readStream = fs__WEBPACK_IMPORTED_MODULE_2__.createReadStream(this.retrieveTemporaryFilePath(fileName));\n        return new Promise((resolve, reject) => {\n            const cryptoHashObj = (0,crypto__WEBPACK_IMPORTED_MODULE_5__.createHash)('sha256');\n            readStream.once('error', err => {\n                (0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_8__.logFuseError)(err, 'releaseTemporaryFile');\n                reject((0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('FSE-ENOENT', {\n                    message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_6__.FS_ERRORS['FSE-ENOENT'].message,\n                    path: fileName\n                }));\n            });\n            readStream.on('readable', () => {\n                let chunk;\n                while (null !== (chunk = readStream.read())) {\n                    cryptoHashObj.update(chunk);\n                }\n            });\n            readStream.once('end', () => {\n                const hash = cryptoHashObj.digest('hex');\n                this.persistTemporaryFileAsBlob(fileName, hash)\n                    .then(_ => resolve(hash))\n                    .catch(err => {\n                    (0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_8__.logFuseError)(err, 'releaseTemporaryFile');\n                    reject((0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('FSE-ENOENT', {\n                        message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_6__.FS_ERRORS['FSE-ENOENT'].message,\n                        path: fileName\n                    }));\n                });\n            });\n        });\n    }\n    async writeToTemporaryFile(filepath, buffer, length, position) {\n        const fileName = filepath.substring(filepath.lastIndexOf('/') + 1);\n        this.throwErrorForMacOSHiddenFiles(fileName);\n        const temporaryFile = this.fileToTemporaryFileMap.get(fileName);\n        if (temporaryFile) {\n            return new Promise((resolve, reject) => {\n                fs__WEBPACK_IMPORTED_MODULE_2__.write(temporaryFile.temporaryFileDescriptor, buffer, 0, length, position, (err, written) => {\n                    if (err) {\n                        (0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_8__.logFuseError)(err, 'writeToTemporaryFile');\n                        reject((0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('FSE-EIO', {\n                            message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_6__.FS_ERRORS['FSE-EIO'].message,\n                            path: fileName\n                        }));\n                    }\n                    else {\n                        resolve(written);\n                    }\n                });\n            });\n        }\n        throw (0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('FSE-ENOENT', {\n            message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_6__.FS_ERRORS['FSE-ENOENT'].message,\n            path: fileName\n        });\n    }\n    async persistTemporaryFileAsBlob(temporaryFileName, persistedFileName) {\n        const temporaryFile = this.fileToTemporaryFileMap.get(temporaryFileName);\n        if (!temporaryFile) {\n            throw (0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('FSE-ENOENT', {\n                message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_6__.FS_ERRORS['FSE-ENOENT'].message,\n                path: temporaryFileName\n            });\n        }\n        const persistedFilePath = path__WEBPACK_IMPORTED_MODULE_1__.join(FuseTemporaryFilesManager.getOnePath(this.oneStoragePath, 'objects'), persistedFileName);\n        return (0,fs_promises__WEBPACK_IMPORTED_MODULE_3__.stat)(persistedFilePath)\n            .then(stats => {\n            if (stats.size === 0) {\n                return (0,fs_promises__WEBPACK_IMPORTED_MODULE_3__.unlink)(persistedFilePath)\n                    .then(() => (0,fs_promises__WEBPACK_IMPORTED_MODULE_3__.rename)(temporaryFile.temporaryFilePath, persistedFilePath).then(() => {\n                    return new Promise((resolve, reject) => fs__WEBPACK_IMPORTED_MODULE_2__.close(temporaryFile.temporaryFileDescriptor, closeErr => {\n                        if (closeErr) {\n                            (0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_8__.logFuseError)(closeErr, 'persistTemporaryFileAsBlob');\n                            reject((0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('SST-MV3', {\n                                message: `File not found: ${temporaryFileName}`,\n                                path: temporaryFileName\n                            }));\n                        }\n                        else {\n                            this.fileToTemporaryFileMap.delete(temporaryFileName);\n                            resolve(_refinio_one_core_lib_storage_base_common_js__WEBPACK_IMPORTED_MODULE_7__.CREATION_STATUS.NEW);\n                        }\n                    }));\n                }))\n                    .catch(unlinkErr => {\n                    if (unlinkErr.code === 'ENOENT') {\n                        throw (0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('SST-MV2', {\n                            message: `File not found: ${temporaryFileName}`,\n                            path: temporaryFileName\n                        });\n                    }\n                    throw (0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('SST-MV6', unlinkErr);\n                });\n            }\n            throw (0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('SST-MV7', {\n                message: `Move operation failed from ${temporaryFile.temporaryFilePath} to ${persistedFilePath}`,\n                path: temporaryFile.temporaryFilePath\n            });\n        })\n            .catch((err) => {\n            if (err.code === 'ENOENT') {\n                return (0,fs_promises__WEBPACK_IMPORTED_MODULE_3__.rename)(temporaryFile.temporaryFilePath, persistedFilePath)\n                    .then(() => {\n                    return new Promise((resolve, reject) => fs__WEBPACK_IMPORTED_MODULE_2__.close(temporaryFile.temporaryFileDescriptor, closeErr => {\n                        if (closeErr) {\n                            (0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_8__.logFuseError)(closeErr, 'persistTemporaryFileAsBlob');\n                            reject((0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('SST-MV3', {\n                                message: `File not found: ${temporaryFileName}`,\n                                path: temporaryFileName\n                            }));\n                        }\n                        else {\n                            this.fileToTemporaryFileMap.delete(temporaryFileName);\n                            resolve(_refinio_one_core_lib_storage_base_common_js__WEBPACK_IMPORTED_MODULE_7__.CREATION_STATUS.NEW);\n                        }\n                    }));\n                })\n                    .catch((renameErr) => {\n                    if (renameErr.code === 'ENOENT') {\n                        throw (0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('SST-MV3', {\n                            message: `File not found: ${temporaryFileName}`,\n                            path: temporaryFileName\n                        });\n                    }\n                    throw (0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('SST-MV4', renameErr);\n                });\n            }\n            throw (0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('SST-MV5', err);\n        });\n    }\n    throwErrorForMacOSHiddenFiles(fileName) {\n        if (this.platform === 'darwin' && fileName.startsWith('.')) {\n            (0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_8__.logFuseError)((0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('FSE-MACH', {\n                message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_6__.FS_ERRORS['FSE-MACH'].message,\n                path: fileName\n            }), 'throwErrorForMacOSHiddenFiles');\n            throw (0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('FSE-MACH', {\n                message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_6__.FS_ERRORS['FSE-MACH'].message,\n                path: fileName\n            });\n        }\n    }\n    retrieveTemporaryFilePath(fileName) {\n        this.throwErrorForMacOSHiddenFiles(fileName);\n        const existingFile = this.fileToTemporaryFileMap.get(fileName);\n        if (!existingFile) {\n            throw (0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('FSE-ENOENT', {\n                message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_6__.FS_ERRORS['FSE-ENOENT'].message,\n                path: fileName\n            });\n        }\n        return existingFile.temporaryFilePath;\n    }\n    async createTemporaryFile(fileName) {\n        this.throwErrorForMacOSHiddenFiles(fileName);\n        const tmpFilePath = path__WEBPACK_IMPORTED_MODULE_1__.join(FuseTemporaryFilesManager.getOnePath(this.oneStoragePath, 'tmp'), (0,_refinio_one_core_lib_storage_base_common_js__WEBPACK_IMPORTED_MODULE_7__.createTempFileName)());\n        try {\n            const fd = fs__WEBPACK_IMPORTED_MODULE_2__.openSync(tmpFilePath, 'a');\n            this.fileToTemporaryFileMap.set(fileName, {\n                temporaryFilePath: tmpFilePath,\n                temporaryFileDescriptor: fd\n            });\n            return fd;\n        }\n        catch (err) {\n            (0,_misc_fuseHelper_js__WEBPACK_IMPORTED_MODULE_8__.logFuseError)(err, 'createTemporaryFile');\n            throw (0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_0__.createError)('FSE-ENOENT', {\n                message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_6__.FS_ERRORS['FSE-ENOENT'].message,\n                path: fileName\n            });\n        }\n    }\n}\n//# sourceMappingURL=FuseTemporaryFilesManager.js.map\n\n//# sourceURL=webpack://one-filer-login/../lib/filer/FuseTemporaryFilesManager.js?\n}");

/***/ }),

/***/ "../lib/fuse/index.js":
/*!****************************!*\
  !*** ../lib/fuse/index.js ***!
  \****************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getFuse: () => (/* binding */ getFuse),\n/* harmony export */   platform: () => (/* binding */ platform)\n/* harmony export */ });\nconst isWindows = process.platform === 'win32';\nconst isLinux = process.platform === 'linux';\nasync function getFuse() {\n    console.log(`ðŸ”§ Loading FUSE implementation for platform: ${process.platform}`);\n    if (isWindows) {\n        throw new Error('FUSE not supported on Windows - use ProjFS mode instead');\n    }\n    else {\n        console.log('ðŸ§ Loading Linux FUSE3...');\n        const { Fuse } = await __webpack_require__.e(/*! import() */ \"lib_fuse_native-fuse3_js\").then(__webpack_require__.bind(__webpack_require__, /*! ./native-fuse3.js */ \"../lib/fuse/native-fuse3.js\"));\n        return Fuse;\n    }\n}\nlet Fuse;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (new Proxy({}, {\n    get(target, prop) {\n        if (!Fuse) {\n            throw new Error('FUSE implementation not loaded yet. Use getFuse() for async loading.');\n        }\n        return Fuse[prop];\n    },\n    construct(target, args) {\n        if (!Fuse) {\n            throw new Error('FUSE implementation not loaded yet. Use getFuse() for async loading.');\n        }\n        return new Fuse(...args);\n    }\n}));\nconst platform = {\n    isWindows,\n    isLinux,\n    isSupported: isWindows || isLinux\n};\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack://one-filer-login/../lib/fuse/index.js?\n}");

/***/ }),

/***/ "../lib/fuse/types.js":
/*!****************************!*\
  !*** ../lib/fuse/types.js ***!
  \****************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   EACCES: () => (/* binding */ EACCES),\n/* harmony export */   EBUSY: () => (/* binding */ EBUSY),\n/* harmony export */   EEXIST: () => (/* binding */ EEXIST),\n/* harmony export */   EINVAL: () => (/* binding */ EINVAL),\n/* harmony export */   EIO: () => (/* binding */ EIO),\n/* harmony export */   EISDIR: () => (/* binding */ EISDIR),\n/* harmony export */   ENOENT: () => (/* binding */ ENOENT),\n/* harmony export */   ENOSPC: () => (/* binding */ ENOSPC),\n/* harmony export */   ENOTDIR: () => (/* binding */ ENOTDIR),\n/* harmony export */   ENOTEMPTY: () => (/* binding */ ENOTEMPTY),\n/* harmony export */   EPERM: () => (/* binding */ EPERM),\n/* harmony export */   EROFS: () => (/* binding */ EROFS)\n/* harmony export */ });\nconst EPERM = 1;\nconst ENOENT = 2;\nconst EIO = 5;\nconst EACCES = 13;\nconst EEXIST = 17;\nconst ENOTDIR = 20;\nconst EISDIR = 21;\nconst EINVAL = 22;\nconst ENOSPC = 28;\nconst EROFS = 30;\nconst EBUSY = 16;\nconst ENOTEMPTY = 39;\n//# sourceMappingURL=types.js.map\n\n//# sourceURL=webpack://one-filer-login/../lib/fuse/types.js?\n}");

/***/ }),

/***/ "../lib/misc/fuseHelper.js":
/*!*********************************!*\
  !*** ../lib/misc/fuseHelper.js ***!
  \*********************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handleError: () => (/* binding */ handleError),\n/* harmony export */   logFuseError: () => (/* binding */ logFuseError),\n/* harmony export */   splitRoutePath: () => (/* binding */ splitRoutePath)\n/* harmony export */ });\n/* harmony import */ var _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @refinio/one.models/lib/fileSystems/FileSystemErrors.js */ \"../node_modules/@refinio/one.models/lib/fileSystems/FileSystemErrors.js\");\n/* harmony import */ var _refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @refinio/one.core/lib/errors.js */ \"../node_modules/@refinio/one.core/lib/errors.js\");\n/* harmony import */ var _fuse_types_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../fuse/types.js */ \"../lib/fuse/types.js\");\n/* harmony import */ var _refinio_one_core_lib_logger_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @refinio/one.core/lib/logger.js */ \"../node_modules/@refinio/one.core/lib/logger.js\");\n\n\n\n\nfunction splitRoutePath(routePath) {\n    const dirs = routePath.split('/');\n    let prefix = '';\n    if (dirs.length > 1) {\n        prefix = dirs[1];\n    }\n    let rest = '/';\n    if (dirs.length > 2) {\n        rest += dirs.slice(2).join('/');\n    }\n    return {\n        prefix: prefix,\n        rest: rest\n    };\n}\nconst FUSE_TO_FS_ERRORS = {\n    [_fuse_types_js__WEBPACK_IMPORTED_MODULE_2__.EPERM]: 'FSE-EPERM',\n    [_fuse_types_js__WEBPACK_IMPORTED_MODULE_2__.ENOENT]: 'FSE-ENOENT',\n    [_fuse_types_js__WEBPACK_IMPORTED_MODULE_2__.EIO]: 'FSE-EIO',\n    [_fuse_types_js__WEBPACK_IMPORTED_MODULE_2__.EACCES]: 'FSE-EACCES',\n    [_fuse_types_js__WEBPACK_IMPORTED_MODULE_2__.EEXIST]: 'FSE-EEXIST',\n    [_fuse_types_js__WEBPACK_IMPORTED_MODULE_2__.ENOTDIR]: 'FSE-ENOTDIR',\n    [_fuse_types_js__WEBPACK_IMPORTED_MODULE_2__.EISDIR]: 'FSE-EISDIR',\n    [_fuse_types_js__WEBPACK_IMPORTED_MODULE_2__.EINVAL]: 'FSE-EINVAL',\n    [_fuse_types_js__WEBPACK_IMPORTED_MODULE_2__.ENOSPC]: 'FSE-ENOSPC',\n    [_fuse_types_js__WEBPACK_IMPORTED_MODULE_2__.EROFS]: 'FSE-EROFS',\n    [_fuse_types_js__WEBPACK_IMPORTED_MODULE_2__.EBUSY]: 'FSE-EBUSY',\n    [_fuse_types_js__WEBPACK_IMPORTED_MODULE_2__.ENOTEMPTY]: 'FSE-ENOTEMPTY'\n};\nfunction mapFuseError(fuseCode, path) {\n    const fsErrorCode = FUSE_TO_FS_ERRORS[fuseCode];\n    if (fsErrorCode) {\n        return (0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_1__.createError)(fsErrorCode, {\n            message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_0__.FS_ERRORS[fsErrorCode].message,\n            path\n        });\n    }\n    return (0,_refinio_one_core_lib_errors_js__WEBPACK_IMPORTED_MODULE_1__.createError)('FSE-UNK', {\n        message: _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_0__.FS_ERRORS['FSE-UNK'].message,\n        path\n    });\n}\nfunction logFuseError(error, operation, severity = 'error') {\n    const color = severity === 'error' ? _refinio_one_core_lib_logger_js__WEBPACK_IMPORTED_MODULE_3__.COLOR.FG_RED : _refinio_one_core_lib_logger_js__WEBPACK_IMPORTED_MODULE_3__.COLOR.FG_YELLOW;\n    console.log(`${color}[${severity.toUpperCase()}]:${_refinio_one_core_lib_logger_js__WEBPACK_IMPORTED_MODULE_3__.COLOR.OFF}`, `Operation: ${operation}`, `Path: ${error.path || 'unknown'}`, `Error: ${error.message}`);\n    if (error.stack) {\n        console.log(error.stack);\n    }\n}\nfunction handleError(err, logCalls = false, operation = 'unknown') {\n    if (typeof err === 'number') {\n        const mappedError = mapFuseError(err);\n        if (logCalls) {\n            logFuseError(mappedError, operation);\n        }\n        return err;\n    }\n    if (logCalls) {\n        logFuseError(err, operation);\n    }\n    if (err.message && err.message.includes(':')) {\n        const code = err.message.slice(0, err.message.indexOf(':'));\n        if (_refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_0__.FS_ERRORS[code]) {\n            if (_refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_0__.FS_ERRORS[code].linuxErrCode === _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_0__.FS_INTERNAL_ERROR_CODE) {\n                console.log(new Error().stack);\n                console.error(err);\n                return 0;\n            }\n            return _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_0__.FS_ERRORS[code].linuxErrCode;\n        }\n    }\n    if (err.code && _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_0__.FS_ERRORS[err.code]) {\n        return _refinio_one_models_lib_fileSystems_FileSystemErrors_js__WEBPACK_IMPORTED_MODULE_0__.FS_ERRORS[err.code].linuxErrCode;\n    }\n    console.log(new Error().stack);\n    console.error(err);\n    return 0;\n}\n//# sourceMappingURL=fuseHelper.js.map\n\n//# sourceURL=webpack://one-filer-login/../lib/misc/fuseHelper.js?\n}");

/***/ }),

/***/ "../node_modules/@refinio/one.core/lib/logger.js":
/*!*******************************************************!*\
  !*** ../node_modules/@refinio/one.core/lib/logger.js ***!
  \*******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   COLOR: () => (/* binding */ COLOR),\n/* harmony export */   startLogger: () => (/* binding */ startLogger),\n/* harmony export */   stopLogger: () => (/* binding */ stopLogger)\n/* harmony export */ });\n/* harmony import */ var _instance_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./instance.js */ \"../node_modules/@refinio/one.core/lib/instance.js\");\n/* harmony import */ var _message_bus_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./message-bus.js */ \"../node_modules/@refinio/one.core/lib/message-bus.js\");\n/* harmony import */ var _system_platform_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./system/platform.js */ \"../node_modules/@refinio/one.core/lib/system/platform.js\");\n/* harmony import */ var _util_type_checks_basic_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./util/type-checks-basic.js */ \"../node_modules/@refinio/one.core/lib/util/type-checks-basic.js\");\n/**\n * @author Michael Hasenstein <hasenstein@yahoo.com>\n * @copyright REFINIO GmbH 2017\n * @license CC-BY-NC-SA-2.5; portions MIT License\n * @version 0.0.1\n */\n/**\n * This module attaches to the global MessageBus and after start attaches to all events of the types\n * \"debug\", \"log\", \"alert\" and \"error\". It uses regular `console.log()` statements but adds\n * colorization for each message type. It was made for Node.js and browser console environments.\n *\n * Defines a static namespace object. By using this object the destination of the log can easily\n * be changed. It also supports severity levels, and for production COLOR lower level calls to\n * the log function can be stripped from the source COLOR entirely by grepping for severity\n * level keywords. Development may prefer logs to the console while production COLOR would log via\n * XHR calls to a server.\n *\n * Example\n *\n * ```\n * import {start as startLogger} from 'one.core/lib/logger';\n * startLogger();\n * ```\n * @private\n * @module\n */\n/* eslint-disable no-console */\n\n\n\n\nconst MessageBus = (0,_message_bus_js__WEBPACK_IMPORTED_MODULE_1__.createMessageBus)('logger');\n/**\n * A selection of colors and text effects for console output.\n *\n * - browser: Terminal colors for the browser console\n * See {@link https://stackoverflow.com/q/7505623/544779}\n *\n * - node.js: ANSI terminal codes to turn on certain font effects\n * See {@link https://stackoverflow.com/q/4842424/544779}\n * @global\n * @type {object}\n */\nconst COLOR = _system_platform_js__WEBPACK_IMPORTED_MODULE_2__.isBrowser\n    ? {\n        OFF: '',\n        BOLD_ON: 'font-weight: bold;',\n        BOLD_OFF: 'font-weight: normal;',\n        FG_BLACK: 'color: black;',\n        FG_RED: 'color: red;',\n        FG_GREEN: 'color: green;',\n        FG_YELLOW: 'color: gray;', // yellow, but that is hard to read on white browser background\n        FG_BLUE: 'color: blue;',\n        FG_MAGENTA: 'color: magenta;',\n        FG_CYAN: 'color: cyan;',\n        FG_WHITE: 'color: white;',\n        BG_BLACK: 'background-color: black;',\n        BG_RED: 'background-color: red;',\n        BG_GREEN: 'background-color: green;',\n        BG_YELLOW: 'background-color: yellow;',\n        BG_BLUE: 'background-color: blue;',\n        BG_MAGENTA: 'background-color: magenta;',\n        BG_CYAN: 'background-color: cyan;',\n        BG_WHITE: 'background-color: white;'\n    }\n    : {\n        OFF: '\\x1b[0m',\n        BOLD_ON: '\\x1b[1m',\n        BOLD_OFF: '\\x1b[22m',\n        FG_BLACK: '\\x1b[30m',\n        FG_RED: '\\x1b[31m',\n        FG_GREEN: '\\x1b[32m',\n        FG_YELLOW: '\\x1b[33m',\n        FG_BLUE: '\\x1b[34m',\n        FG_MAGENTA: '\\x1b[35m',\n        FG_CYAN: '\\x1b[36m',\n        FG_WHITE: '\\x1b[37m',\n        BG_BLACK: '',\n        BG_RED: '\\x1b[41m',\n        BG_GREEN: '\\x1b[42m',\n        BG_YELLOW: '\\x1b[43m',\n        BG_BLUE: '\\x1b[44m',\n        BG_MAGENTA: '\\x1b[45m',\n        BG_CYAN: '\\x1b[46m',\n        BG_WHITE: '\\x1b[47m'\n    };\n// Assign ANSI effect codes to log levels\nconst LEVEL_COLOR = _system_platform_js__WEBPACK_IMPORTED_MODULE_2__.isBrowser\n    ? {\n        debug: COLOR.FG_YELLOW,\n        log: COLOR.FG_GREEN,\n        alert: COLOR.BG_WHITE + COLOR.FG_BLUE,\n        error: COLOR.BOLD_ON + COLOR.FG_RED\n    }\n    : {\n        debug: COLOR.FG_YELLOW,\n        log: COLOR.FG_GREEN,\n        alert: COLOR.BG_WHITE + COLOR.FG_BLUE,\n        error: COLOR.BOLD_ON + COLOR.FG_RED\n    };\nconst LOG_LEVELS = ['debug', 'log', 'alert', 'error'];\n/**\n * @private\n * @typedef {object} Logger\n * @property {Function} debug - This function is used to write \"debug\" messages to the console.\n * @property {Function} log - This function is used to write \"log\" messages to the console.\n * @property {Function} alert - This function is used to write \"alert\" messages to the console.\n * @property {Function} error - This function is used to write \"error\" messages to the console.\n * @private\n * @type {Logger}\n */\nconst Log = {\n// About the type cast: Filled with its elements in the loop just below\n};\nlet printInstanceName = false;\nlet printTimestamp = false;\n// Create logging functions with the id of the module that is going to use them\n// already pre-filled, and ANSI color codes as well.\nLOG_LEVELS.forEach(level => {\n    Log[level] = (id, ...messages) => {\n        const instanceName = (0,_instance_js__WEBPACK_IMPORTED_MODULE_0__.getInstanceName)() ?? 'n/a';\n        const name = printInstanceName ? '[' + instanceName + '] ' : '';\n        const date = new Date();\n        const ts = printTimestamp\n            ? `${date.getDate()}.${date.getMonth() + 1}.${date.getFullYear()} @ ${date.getHours()}:${date.getMinutes()}:${date.getSeconds()} `\n            : '';\n        _system_platform_js__WEBPACK_IMPORTED_MODULE_2__.isBrowser\n            ? console.log(`${name}${ts}%c ${id} ${level} ${messages.join(' ')}`, LEVEL_COLOR[level])\n            : // Use \"+\" to add the ANSI codes because console.log turns commas into spaces\n                console.log(...[name + LEVEL_COLOR[level] + id, level, COLOR.OFF], ...messages);\n    };\n});\n/**\n * @private\n * @param {string} type\n * @param {string} src\n * @param {Array<*>} messages\n * @returns {undefined}\n */\nfunction log(type, src, messages) {\n    let level;\n    if (LOG_LEVELS.includes(type)) {\n        level = type;\n    }\n    else {\n        const elements = type.split(':');\n        const lastElement = elements[elements.length - 1];\n        if (LOG_LEVELS.includes(lastElement)) {\n            level = lastElement;\n        }\n        else {\n            level = 'debug';\n        }\n    }\n    Log[level](src, messages\n        .map(msg => {\n        if ((0,_util_type_checks_basic_js__WEBPACK_IMPORTED_MODULE_3__.isObject)(msg)) {\n            // Use \"duck typing\" because \"msg instanceof Error\" would fail across execution\n            // contexts (frames, windows, node's vm.runInNewContext, etc.)\n            if ((0,_util_type_checks_basic_js__WEBPACK_IMPORTED_MODULE_3__.isString)(msg.message) && (0,_util_type_checks_basic_js__WEBPACK_IMPORTED_MODULE_3__.isString)(msg.stack)) {\n                // Make sure to include all guaranteed-to-be-there Error properties on all\n                // platforms, and go through a set to ensure we include them only once\n                return [\n                    'name',\n                    'message',\n                    'stack',\n                    ...Reflect.ownKeys(msg).filter(_util_type_checks_basic_js__WEBPACK_IMPORTED_MODULE_3__.isString)\n                ]\n                    .filter((item, index, arr) => arr.indexOf(item) === index)\n                    .map(key => msg[key])\n                    .join(' ');\n            }\n            // A circle-proof JSON.stringify. Details are lost - better than a crash.\n            // DETECTS ALL DUPLICATE REFERENCES - not just circles. Actually dealing with\n            // loops would take quite a bit more code, not worth it for this logging\n            // function.\n            const seenObjects = new Set();\n            return JSON.stringify(msg, (_key, value) => {\n                if ((0,_util_type_checks_basic_js__WEBPACK_IMPORTED_MODULE_3__.isObject)(value)) {\n                    if (seenObjects.has(value)) {\n                        return '[~CIRCLE-OR-DUPLICATE]';\n                    }\n                    seenObjects.add(value);\n                }\n                return value;\n            }, 4);\n        }\n        return msg;\n    })\n        .join('\\n'));\n}\n// ------------------------------------------------------------------------------------\n// LOG ANYTHING!\n// Attach to _any_ event, send to the desired log-level function.\n// ------------------------------------------------------------------------------------\nconst disconnectLogCallbacks = [];\n/**\n * This function attaches the log functions for message bus message types \"debug\", \"log\",\n * \"alert\" and \"error\" to the message bus. The function take an option object parameter.\n * @static\n * @param {object} options\n * @param {boolean} [options.includeInstanceName=false] - If set to true the console output is\n * going to include the name of the instance\n * @param {boolean} [options.includeTimestamp=false] - If set to true the console output is\n * going to include the current date and time\n * @param {boolean} [options.types=['error','alert','log','debug']] - Which message types to\n * subscribe to for logging? If none are provided subscribe to the four default log message types.\n * @returns {undefined} Returns nothing\n */\nfunction startLogger({ includeInstanceName = false, includeTimestamp = false, types = LOG_LEVELS } = {}) {\n    printInstanceName = includeInstanceName;\n    printTimestamp = includeTimestamp;\n    for (const type of types) {\n        const fn = (src, ...messages) => log(type, src, messages);\n        MessageBus.on(type, fn);\n        disconnectLogCallbacks.push(MessageBus.remove.bind(null, type, fn));\n    }\n    MessageBus.send('log', 'Logger started.');\n}\n/**\n * Disconnect all log callbacks on the message buses.\n */\nfunction stopLogger() {\n    MessageBus.send('log', 'Logger stopped.');\n    for (const disconnectLogCallback of disconnectLogCallbacks) {\n        disconnectLogCallback();\n    }\n    disconnectLogCallbacks.splice(0, disconnectLogCallbacks.length);\n}\n//# sourceMappingURL=logger.js.map\n\n//# sourceURL=webpack://one-filer-login/../node_modules/@refinio/one.core/lib/logger.js?\n}");

/***/ })

};
;